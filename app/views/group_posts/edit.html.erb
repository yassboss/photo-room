<%= form_with model: @group_post, local: true do |f| %>
<%= render 'layouts/error_messages', model: f.object %>

  <div>
    <%= @group_post.group.name %>
    <%= f.hidden_field :group_id, value: @group_post.group.id %>
  </div>
  <div class="title-field">
    <p>タイトル</p>
    <%= f.text_field :group_title, placeholder: 'group_title' %>
  </div>
  <div class="text-field">
    <p>テキスト</p>
    <%= f.text_area :group_text, placeholder: 'group_text' %>
  </div>

  <div id="detail-association-insertion-point">
    <%= f.fields_for :posts do |post_field| %>
      <%= render 'post_fields', f: post_field %>
    <% end %>
  </div>

  <div class="add-botton-box">
    <%= link_to_add_association "追加ボタン", f, :posts,
    class: 'add_fields',
    id: 'add-btn',
    data: {
      association_insertion_node: '#detail-association-insertion-point',
      association_insertion_method: 'append'
      }
    %>
  </div>
  
  <div class="submit-btn">
    <%= f.submit '送信' %>
  </div>

<% end %>

<script>
function loadImage(obj){
  let preview = obj.closest('.image-field').firstElementChild;
  preview.innerHTML = '<p>プレビュー</p>';
	for (i = 0; i < obj.files.length; i++) {
		var fileReader = new FileReader();
		fileReader.onload = (function (e) {
      preview.innerHTML += '<img src="' + e.target.result + '">';
		});
		fileReader.readAsDataURL(obj.files[i]);
	};
};
</script>